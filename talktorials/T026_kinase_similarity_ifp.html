
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

<meta property="og:title" content="T026 · Kinase similarity: Interaction fingerprints" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="https://projects.volkamerlab.org/teachopencadd/talktorials/T026_kinase_similarity_ifp.html" />
  
<meta property="og:description" content="Note: This talktorial is a part of TeachOpenCADD, a platform that aims to teach domain-specific skills and to provide pipeline templates as starting points for research projects. Authors: Dominique Sydow, 2021, Volkamer lab, Charité, Talia B. Kimber, 2021, Volkamer lab, Charité, Andrea Volkamer, ..." />
  
<meta property="og:image" content="https://raw.githubusercontent.com/volkamerlab/teachopencadd/master/docs/_static/images/TeachOpenCADD_topics.png" />
  
<meta property="og:image:alt" content="T026 · Kinase similarity: Interaction fingerprints" />
  
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#2196f3">
  <script src="../_static/javascripts/modernizr.js"></script>
  
    <script async src="../_static/cookieconsent.min.js"></script>
    <script>
        window.addEventListener("load", function(){
        window.cookieconsent.initialise({
            "palette": {
            "popup": {
                "background": "#f0f0f0",
                "text": "#999"
            },
            "button": {
                "text": "#fff",
                "background": "#009688"
            }
            },
            "theme": "classic"
        })});
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q6ZE82CNZB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-Q6ZE82CNZB');
    </script>
  
    <link rel="apple-touch-icon" href="../_static/images/apple-icon-152x152.png"/>
  
  
    <title>T026 · Kinase similarity: Interaction fingerprints &#8212; TeachOpenCADD 0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="T027 · Kinase similarity: Ligand profile" href="T027_kinase_similarity_ligand_profile.html" />
    <link rel="prev" title="T025 · Kinase similarity: Kinase pocket (KiSSim fingerprint)" href="T025_kinase_similarity_kissim.html" />
  
    <link rel="apple-touch-icon" href="../_static/images/apple-icon-152x152.png"/>
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=teal data-md-color-accent=cyan>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#talktorials/T026_kinase_similarity_ifp" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="TeachOpenCADD 0 documentation"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">TeachOpenCADD</span>
          <span class="md-header-nav__topic"> T026 · Kinase similarity: Interaction fingerprints </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/volkamerlab/teachopencadd/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TeachOpenCADD
  </div>
</a>
          </div>
        </div>
      
      
    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../talktorials.html" class="md-tabs__link">Our talktorials</a></li>
            
            <li class="md-tabs__item"><a href="../installing.html" class="md-tabs__link">Run locally</a></li>
            
            <li class="md-tabs__item"><a href="../contribute.html" class="md-tabs__link">Contribute</a></li>
          <li class="md-tabs__item"><a href="../all_talktorials.html" class="md-tabs__link">Complete list of talktorials</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="TeachOpenCADD 0 documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    <a href="../index.html"
       title="TeachOpenCADD 0 documentation">TeachOpenCADD</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/volkamerlab/teachopencadd/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TeachOpenCADD
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Our talktorials</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../all_talktorials.html" class="md-nav__link">Complete list of talktorials</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html" class="md-nav__link">Talktorials by collection</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#edition-2019-jcim" class="md-nav__link">Edition 2019 - JCIM</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#edition-2021" class="md-nav__link">Edition 2021</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#ligand-based-cheminformatics" class="md-nav__link">Ligand-based cheminformatics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#structural-biology" class="md-nav__link">Structural biology</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#online-apis-servers" class="md-nav__link">Online APIs/servers</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#kinase-similarity" class="md-nav__link">Kinase similarity</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Run locally</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installing.html" class="md-nav__link">Installing</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Contributors</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../contribute.html" class="md-nav__link">For contributors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../api.html" class="md-nav__link">API Documentation</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">External resources</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../external_dependencies.html" class="md-nav__link">Packages and webservers used in TeachOpenCADD</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../external_tutorials_collections.html" class="md-nav__link">External tutorials and collections</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#talktorials-t026-kinase-similarity-ifp--page-root" class="md-nav__link">T026 · Kinase similarity: Interaction fingerprints</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Aim-of-this-talktorial" class="md-nav__link">Aim of this talktorial</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Contents-in-Theory" class="md-nav__link">Contents in <em>Theory</em></a>
        </li>
        <li class="md-nav__item"><a href="#Contents-in-Practical" class="md-nav__link">Contents in <em>Practical</em></a>
        </li>
        <li class="md-nav__item"><a href="#References" class="md-nav__link">References</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Theory" class="md-nav__link">Theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Kinase-dataset" class="md-nav__link">Kinase dataset</a>
        </li>
        <li class="md-nav__item"><a href="#Kinase-similarity-descriptor:-KLIFS-interaction-fingerprints" class="md-nav__link">Kinase similarity descriptor: KLIFS interaction fingerprints</a>
        </li>
        <li class="md-nav__item"><a href="#Fetching-KLIFS-data-with-opencadd.databases.klifs" class="md-nav__link">Fetching KLIFS data with <code class="docutils literal notranslate"><span class="pre">opencadd.databases.klifs</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Practical" class="md-nav__link">Practical</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Define-the-kinases-of-interest" class="md-nav__link">Define the kinases of interest</a>
        </li>
        <li class="md-nav__item"><a href="#Retrieve-and-preprocess-data" class="md-nav__link">Retrieve and preprocess data</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Set-up-a-remote-KLIFS-session" class="md-nav__link">Set up a remote KLIFS session</a>
        </li>
        <li class="md-nav__item"><a href="#Fetch-all-structures-describing-these-kinases" class="md-nav__link">Fetch all structures describing these kinases</a>
        </li>
        <li class="md-nav__item"><a href="#Filter-structures" class="md-nav__link">Filter structures</a>
        </li>
        <li class="md-nav__item"><a href="#Fetch-the-structures’-IFPs-(if-available)" class="md-nav__link">Fetch the structures’ IFPs (if available)</a>
        </li>
        <li class="md-nav__item"><a href="#Merge-structural-and-IFP-data" class="md-nav__link">Merge structural and IFP data</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Show-kinase-coverage" class="md-nav__link">Show kinase coverage</a>
        </li>
        <li class="md-nav__item"><a href="#Compare-structures" class="md-nav__link">Compare structures</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Prepare-IFPs-as-numpy-array" class="md-nav__link">Prepare IFPs as <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array</a>
        </li>
        <li class="md-nav__item"><a href="#Calculate-pairwise-Jaccard-distances" class="md-nav__link">Calculate pairwise Jaccard distances</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Map-structure-to-kinase-distance-matrix" class="md-nav__link">Map structure to kinase distance matrix</a>
        </li>
        <li class="md-nav__item"><a href="#Save-kinase-distance-matrix" class="md-nav__link">Save kinase distance matrix</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Discussion" class="md-nav__link">Discussion</a>
        </li>
        <li class="md-nav__item"><a href="#Quiz" class="md-nav__link">Quiz</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/talktorials/T026_kinase_similarity_ifp.nblink.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="T026-·-Kinase-similarity:-Interaction-fingerprints">
<h1 id="talktorials-t026-kinase-similarity-ifp--page-root">T026 · Kinase similarity: Interaction fingerprints<a class="headerlink" href="#talktorials-t026-kinase-similarity-ifp--page-root" title="Permalink to this heading">¶</a></h1>
<p><strong>Note:</strong> This talktorial is a part of TeachOpenCADD, a platform that aims to teach domain-specific skills and to provide pipeline templates as starting points for research projects.</p>
<p>Authors:</p>
<ul class="simple">
<li><p>Dominique Sydow, 2021, <a class="reference external" href="https://volkamerlab.org/">Volkamer lab, Charité</a></p></li>
<li><p>Talia B. Kimber, 2021, <a class="reference external" href="https://volkamerlab.org/">Volkamer lab, Charité</a></p></li>
<li><p>Andrea Volkamer, 2021, <a class="reference external" href="https://volkamerlab.org/">Volkamer lab, Charité</a></p></li>
</ul>
<section id="Aim-of-this-talktorial">
<h2 id="Aim-of-this-talktorial">Aim of this talktorial<a class="headerlink" href="#Aim-of-this-talktorial" title="Permalink to this heading">¶</a></h2>
<p>We will assess the similarity between a set of kinases based on detected protein-ligand interactions in available complex structures. The <a class="reference external" href="https://klifs.net/">KLIFS</a> interaction fingerprint (IFP), which describes the interactions seen in a structurally resolved kinase-ligand complex, will be used in this exercise.</p>
<p><em>Note</em>: We focus on similarities between orthosteric kinase binding sites; similarities to allosteric binding sites are not covered.</p>
<section id="Contents-in-Theory">
<h3 id="Contents-in-Theory">Contents in <em>Theory</em><a class="headerlink" href="#Contents-in-Theory" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Kinase dataset</p></li>
<li><p>Kinase similarity descriptor: KLIFS interaction fingerprint</p></li>
<li><p>Fetching KLIFS data with <code class="docutils literal notranslate"><span class="pre">opencadd.databases.klifs</span></code></p></li>
</ul>
</section>
<section id="Contents-in-Practical">
<h3 id="Contents-in-Practical">Contents in <em>Practical</em><a class="headerlink" href="#Contents-in-Practical" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Define the kinases of interest</p></li>
<li><p>Retrieve and preprocess data</p>
<ul>
<li><p>Set up a remote KLIFS session</p></li>
<li><p>Fetch all structures describing these kinases</p></li>
<li><p>Filter structures</p></li>
<li><p>Fetch the structures’ IFPs (if available)</p></li>
<li><p>Merge structural and IFP data</p></li>
</ul>
</li>
<li><p>Show kinase coverage</p></li>
<li><p>Compare structures</p>
<ul>
<li><p>Prepare IFPs as <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array</p></li>
<li><p>Calculate pairwise Jaccard distances</p></li>
</ul>
</li>
<li><p>Map structure to kinase distance matrix</p></li>
<li><p>Save kinase distance matrix</p></li>
</ul>
</section>
<section id="References">
<h3 id="References">References<a class="headerlink" href="#References" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Kinase dataset: <a class="reference external" href="https://www.mdpi.com/1420-3049/26/3/629">Molecules (2021), 26(3), 629</a></p></li>
<li><p>Protein Data Bank</p>
<ul>
<li><p>PDB URL: <a class="reference external" href="http://www.rcsb.org/">http://www.rcsb.org/</a></p></li>
<li><p>PDB database: <a class="reference external" href="https://doi.org/10.1107/S0907444902003451">Acta Cryst. (2002), D58, 899-907</a> and <a class="reference external" href="https://doi.org/10.1016/j.str.2012.01.010">Structure (2012), 20(3), 391-396</a></p></li>
</ul>
</li>
<li><p>KLIFS</p>
<ul>
<li><p>KLIFS URL: <a class="reference external" href="https://klifs.net/">https://klifs.net/</a></p></li>
<li><p>KLIFS database: <a class="reference external" href="https://doi.org/10.1093/nar/gkaa895">Nucleic Acid Res. (2020), 49(D1), D562-D569</a></p></li>
<li><p>KLIFS binding site definition and interaction fingerprint calculation: <a class="reference external" href="https://doi.org/10.1021/jm400378w">J. Med. Chem. (2014), 57(2), 249-277</a></p></li>
</ul>
</li>
<li><p>Interaction fingerprint (IFP): <a class="reference external" href="https://doi.org/10.1021/ci600342e">J. Chem. Inf. Model. (2007), 71(1), 195-207</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">opencadd</span></code>, a Python library for structural cheminformatics</p>
<ul>
<li><p>GitHub repository: <a class="reference external" href="https://github.com/volkamerlab/opencadd">https://github.com/volkamerlab/opencadd</a></p></li>
<li><p>Documentation: <a class="reference external" href="https://opencadd.readthedocs.io">https://opencadd.readthedocs.io</a></p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="Theory">
<h2 id="Theory">Theory<a class="headerlink" href="#Theory" title="Permalink to this heading">¶</a></h2>
<section id="Kinase-dataset">
<h3 id="Kinase-dataset">Kinase dataset<a class="headerlink" href="#Kinase-dataset" title="Permalink to this heading">¶</a></h3>
<p>We use the kinase selection as defined in <strong>Talktorial T023</strong>.</p>
</section>
<section id="Kinase-similarity-descriptor:-KLIFS-interaction-fingerprints">
<h3 id="Kinase-similarity-descriptor:-KLIFS-interaction-fingerprints">Kinase similarity descriptor: KLIFS interaction fingerprints<a class="headerlink" href="#Kinase-similarity-descriptor:-KLIFS-interaction-fingerprints" title="Permalink to this heading">¶</a></h3>
<p>Interaction fingerprints (IFPs) encode the binding mode of a ligand in a binding site, i.e., the protein-ligand interactions that are present in a structurally resolved complex. If a ligand can form similar interaction patterns in proteins other than its designated protein (off- vs. on-target), it is possible that this ligand will cause unintended side effects. Knowledge about similarities between proteins can therefore help to avoid such off-target effects; or to exploit the known similarities
for polypharmacology effects where one ligand could intentionally target multiple proteins at once.</p>
<p>In this talktorial, we are interested in assessing the similarity between a set of kinases based on the similarity between the binding modes of the co-crystallized ligands. We will make use of the KLIFS IFP: For each kinase structure that is co-crystallized with a ligand, all interactions between the <span class="math notranslate nohighlight">\(85\)</span> KLIFS pocket residues (see more details in <strong>Talktorial T023</strong>) and the ligand are described using the IFP by Marcou and Rognan (<a class="reference external" href="https://pubs.acs.org/doi/10.1021/ci600342e">JCIM (2007), 71(1),
195-207</a>).</p>
<p>This is how the IFP is explained in the respective KLIFS publication <a class="reference external" href="https://doi.org/10.1021/jm400378w">J. Med. Chem. (2014), 57(2), 249-277</a>:</p>
<blockquote>
<div><p>For each amino acid in the catalytic cleft, seven types of protein−ligand interactions are determined. The presence of a certain type of interaction results in the type-setting of a “1” in the bit-string; otherwise a “0” is used to indicate the absence of the interaction. The following seven types of interactions are summarized in one bit-string; bit 1 = hydrophobic contact (HYD); bit 2 = face to face aromatic interactions (F−F); bit 3 = face to edge aromatic interactions (F−E); bit 4 =
protein H-bond donor (DON); bit 5 = protein H- bond acceptor (ACC); bit 6 = protein cationic interactions (ION+), and bit 7 = protein anionic interactions (ION−).</p>
</div></blockquote>
<p>This results in a <span class="math notranslate nohighlight">\(85 \times 7 = 595\)</span> bit vector. Since the binding site is aligned across all kinases, each bit position in this IFP can be directly compared across all IFPs in KLIFS. This is what we will do in the practical part of this tutorial.</p>
<img alt="KLIFS IFP" src="../_images/T026_KLIFS_IFP.png"/>
<p><em>Figure 1:</em> KLIFS interaction fingerprint (IFP) definition: Seven interaction types are detected between each of a kinase structure’s <span class="math notranslate nohighlight">\(85\)</span> pocket residues and a co-crystallized ligand. Interaction types include: hydrophobic contact (HYD), face to face aromatic interactions (F−F), face to edge aromatic interactions (F−E), protein H-bond donor (DON), protein H-bond acceptor (ACC), protein cationic interactions (ION+), and protein anionic interactions (ION−). Figure by Dominique Sydow,
adapted from: <a class="reference external" href="https://doi.org/10.1021/jm400378w">J. Med. Chem. (2014), 57(2), 249-277</a>.</p>
</section>
<section id="Fetching-KLIFS-data-with-opencadd.databases.klifs">
<h3 id="Fetching-KLIFS-data-with-opencadd.databases.klifs">Fetching KLIFS data with <code class="docutils literal notranslate"><span class="pre">opencadd.databases.klifs</span></code><a class="headerlink" href="#Fetching-KLIFS-data-with-opencadd.databases.klifs" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">opencadd</span></code> is a Python library for structural cheminformatics developed by the <a class="reference external" href="https://volkamerlab.org/">Volkamer lab</a> at the Charité in Berlin. This library is a growing collection of modules that help facilitate and standardize common tasks in structural bioinformatics and cheminformatics. Today, we will use the module <code class="docutils literal notranslate"><span class="pre">opencadd.databases.klifs</span></code>, which allows us to fetch the KLIFS IFP as a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> DataFrame.</p>
<ul class="simple">
<li><p>GitHub repository: <a class="reference external" href="https://github.com/volkamerlab/opencadd">https://github.com/volkamerlab/opencadd</a></p></li>
<li><p>Documentation: <a class="reference external" href="https://opencadd.readthedocs.io">https://opencadd.readthedocs.io</a></p></li>
</ul>
<p>For more information about this library and the KLIFS OpenAPI, please refer to <strong>Talktorial T012</strong>.</p>
</section>
</section>
<section id="Practical">
<h2 id="Practical">Practical<a class="headerlink" href="#Practical" title="Permalink to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">pairwise_distances</span>
<span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">distance</span>
<span class="kn">from</span> <span class="nn">opencadd.databases.klifs</span> <span class="kn">import</span> <span class="n">setup_remote</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HERE</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">_dh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">DATA</span> <span class="o">=</span> <span class="n">HERE</span> <span class="o">/</span> <span class="s2">"data"</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">configs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">HERE</span> <span class="o">/</span> <span class="s2">"../T023_what_is_a_kinase/data/pipeline_configs.csv"</span><span class="p">)</span>
<span class="n">configs</span> <span class="o">=</span> <span class="n">configs</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">"variable"</span><span class="p">)[</span><span class="s2">"default_value"</span><span class="p">]</span>

<span class="n">DEMO</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s2">"DEMO"</span><span class="p">]))</span>
<span class="n">N_STRUCTURES_PER_KINASE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s2">"N_STRUCTURES_PER_KINASE"</span><span class="p">])</span>
<span class="n">N_CORES</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s2">"N_CORES"</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Run in demo mode: </span><span class="si">{</span><span class="n">DEMO</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">DEMO</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">N_STRUCTURES_PER_KINASE</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of structures per kinase: </span><span class="si">{</span><span class="n">N_STRUCTURES_PER_KINASE</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of structures per kinase: all available structures"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of cores used: </span><span class="si">{</span><span class="n">N_CORES</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Run in demo mode: True
</pre></div></div>
</div>
<section id="Define-the-kinases-of-interest">
<h3 id="Define-the-kinases-of-interest">Define the kinases of interest<a class="headerlink" href="#Define-the-kinases-of-interest" title="Permalink to this heading">¶</a></h3>
<p>Let’s load the kinase selection as defined in <strong>Talktorial T023</strong>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kinase_selection_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">HERE</span> <span class="o">/</span> <span class="s2">"../T023_what_is_a_kinase/data/kinase_selection.csv"</span><span class="p">)</span>
<span class="n">kinase_selection_df</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>kinase</th>
<th>kinase_klifs</th>
<th>uniprot_id</th>
<th>group</th>
<th>full_kinase_name</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>EGFR</td>
<td>EGFR</td>
<td>P00533</td>
<td>TK</td>
<td>Epidermal growth factor receptor</td>
</tr>
<tr>
<th>1</th>
<td>ErbB2</td>
<td>ErbB2</td>
<td>P04626</td>
<td>TK</td>
<td>Erythroblastic leukemia viral oncogene homolog 2</td>
</tr>
<tr>
<th>2</th>
<td>PI3K</td>
<td>p110a</td>
<td>P42336</td>
<td>Atypical</td>
<td>Phosphatidylinositol-3-kinase</td>
</tr>
<tr>
<th>3</th>
<td>VEGFR2</td>
<td>KDR</td>
<td>P35968</td>
<td>TK</td>
<td>Vascular endothelial growth factor receptor 2</td>
</tr>
<tr>
<th>4</th>
<td>BRAF</td>
<td>BRAF</td>
<td>P15056</td>
<td>TKL</td>
<td>Rapidly accelerated fibrosarcoma isoform B</td>
</tr>
<tr>
<th>5</th>
<td>CDK2</td>
<td>CDK2</td>
<td>P24941</td>
<td>CMGC</td>
<td>Cyclic-dependent kinase 2</td>
</tr>
<tr>
<th>6</th>
<td>LCK</td>
<td>LCK</td>
<td>P06239</td>
<td>TK</td>
<td>Lymphocyte-specific protein tyrosine kinase</td>
</tr>
<tr>
<th>7</th>
<td>MET</td>
<td>MET</td>
<td>P08581</td>
<td>TK</td>
<td>Mesenchymal-epithelial transition factor</td>
</tr>
<tr>
<th>8</th>
<td>p38a</td>
<td>p38a</td>
<td>Q16539</td>
<td>CMGC</td>
<td>p38 mitogen activated protein kinase alpha</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="Retrieve-and-preprocess-data">
<h3 id="Retrieve-and-preprocess-data">Retrieve and preprocess data<a class="headerlink" href="#Retrieve-and-preprocess-data" title="Permalink to this heading">¶</a></h3>
<p>Now, we query the KLIFS database using the <code class="docutils literal notranslate"><span class="pre">opencadd.databases.klifs</span></code> module to generate our IFP dataset.</p>
<section id="Set-up-a-remote-KLIFS-session">
<h4 id="Set-up-a-remote-KLIFS-session">Set up a remote KLIFS session<a class="headerlink" href="#Set-up-a-remote-KLIFS-session" title="Permalink to this heading">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">opencadd.databases.klifs</span> <span class="kn">import</span> <span class="n">setup_remote</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">klifs_session</span> <span class="o">=</span> <span class="n">setup_remote</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Fetch-all-structures-describing-these-kinases">
<h4 id="Fetch-all-structures-describing-these-kinases">Fetch all structures describing these kinases<a class="headerlink" href="#Fetch-all-structures-describing-these-kinases" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get list of kinase names</span>
<span class="n">kinase_names</span> <span class="o">=</span> <span class="n">kinase_selection_df</span><span class="p">[</span><span class="s2">"kinase_klifs"</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="c1"># Get all available structures for these kinases</span>
<span class="n">structures_df</span> <span class="o">=</span> <span class="n">klifs_session</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">by_kinase_name</span><span class="p">(</span><span class="n">kinase_names</span><span class="o">=</span><span class="n">kinase_names</span><span class="p">)</span>
<span class="c1"># Keep only relevant columns</span>
<span class="n">structures_df</span> <span class="o">=</span> <span class="n">structures_df</span><span class="p">[</span>
    <span class="p">[</span>
        <span class="s2">"structure.klifs_id"</span><span class="p">,</span>
        <span class="s2">"kinase.klifs_name"</span><span class="p">,</span>
        <span class="s2">"species.klifs"</span><span class="p">,</span>
        <span class="s2">"structure.dfg"</span><span class="p">,</span>
        <span class="s2">"structure.resolution"</span><span class="p">,</span>
        <span class="s2">"structure.qualityscore"</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of structures: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">structures_df</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Kinases:"</span><span class="p">,</span> <span class="o">*</span><span class="n">structures_df</span><span class="p">[</span><span class="s2">"kinase.klifs_name"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of structures: 2523
Kinases: CDK2 p38a EGFR ErbB2 MET LCK KDR BRAF p110a
</pre></div></div>
</div>
</section>
<section id="Filter-structures">
<h4 id="Filter-structures">Filter structures<a class="headerlink" href="#Filter-structures" title="Permalink to this heading">¶</a></h4>
<p>We filter the structures by different criteria:</p>
<ul class="simple">
<li><p>Species: human</p></li>
<li><p>Conformation: DFG-in (the active kinase conformation)</p></li>
<li><p>Resolution: <span class="math notranslate nohighlight">\(\le 3\)</span> Angström</p></li>
<li><p>Quality score*: <span class="math notranslate nohighlight">\(\ge 6\)</span></p></li>
</ul>
<p>* The KLIFS quality score takes into account the quality of the alignment, as well as the number of missing residues and atoms. A higher score indicates a better structure quality.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">structures_df</span> <span class="o">=</span> <span class="n">structures_df</span><span class="p">[</span>
    <span class="p">(</span><span class="n">structures_df</span><span class="p">[</span><span class="s2">"species.klifs"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"Human"</span><span class="p">)</span>
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">structures_df</span><span class="p">[</span><span class="s2">"structure.dfg"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"in"</span><span class="p">)</span>
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">structures_df</span><span class="p">[</span><span class="s2">"structure.resolution"</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span>
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">structures_df</span><span class="p">[</span><span class="s2">"structure.qualityscore"</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">)</span>
<span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of structures: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">structures_df</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Kinases:"</span><span class="p">,</span> <span class="o">*</span><span class="n">structures_df</span><span class="p">[</span><span class="s2">"kinase.klifs_name"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of structures: 1657
Kinases: CDK2 p38a EGFR ErbB2 MET LCK KDR BRAF p110a
</pre></div></div>
</div>
<p>Save the structure KLIFS IDs for the next step.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">structure_klifs_ids</span> <span class="o">=</span> <span class="n">structures_df</span><span class="p">[</span><span class="s2">"structure.klifs_id"</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of structures: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">structure_klifs_ids</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of structures: 1657
</pre></div></div>
</div>
<p><em>Note for demo mode</em>: To make it easier for us to maintain the talktorials, we will now load a set of frozen structure KLIFS IDs (2021-08-23) and continue to work with those.</p>
<p><em>Note for non-demo mode</em>: Did you specify <code class="docutils literal notranslate"><span class="pre">N_STRUCTURES_PER_KINASE</span></code> in the configuration file? If you e.g. set a value of 3, we will select in the following the top 3 structures per kinase in terms of resolution and KLIFS quality score.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">DEMO</span><span class="p">:</span>
    <span class="c1"># Load frozen dataset</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Notebook is run in demo mode - load frozen structure set."</span><span class="p">)</span>
    <span class="n">structure_klifs_ids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DATA</span> <span class="o">/</span> <span class="s2">"frozen_structure_klifs_ids.csv"</span><span class="p">)[</span>
        <span class="s2">"structure.klifs_id"</span>
    <span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
    <span class="n">structures_df</span> <span class="o">=</span> <span class="n">structures_df</span><span class="p">[</span>
        <span class="n">structures_df</span><span class="p">[</span><span class="s2">"structure.klifs_id"</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">structure_klifs_ids</span><span class="p">)</span>
    <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">N_STRUCTURES_PER_KINASE</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Select </span><span class="si">{</span><span class="n">N_STRUCTURES_PER_KINASE</span><span class="si">}</span><span class="s2"> structures per kinase for downstream analysis."</span><span class="p">)</span>
        <span class="c1"># Sort structures by kinase and quality</span>
        <span class="n">structures_df</span> <span class="o">=</span> <span class="n">structures_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">"kinase.klifs_name"</span><span class="p">,</span> <span class="s2">"structure.resolution"</span><span class="p">,</span> <span class="s2">"structure.qualityscore"</span><span class="p">],</span>
            <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="c1"># Reduce number of structures per kinase</span>
        <span class="n">structures_df</span> <span class="o">=</span> <span class="n">structures_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"kinase.klifs_name"</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">N_STRUCTURES_PER_KINASE</span><span class="p">)</span>
        <span class="n">structure_klifs_ids</span> <span class="o">=</span> <span class="n">structures_df</span><span class="p">[</span><span class="s2">"structure.klifs_id"</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Use all available structures per kinase for downstream analysis."</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of structures: </span><span class="si">{</span><span class="n">structures_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Notebook is run in demo mode - load frozen structure set.
Number of structures: 1620
</pre></div></div>
</div>
</section>
<section id="Fetch-the-structures’-IFPs-(if-available)">
<h4 id="Fetch-the-structures’-IFPs-(if-available)">Fetch the structures’ IFPs (if available)<a class="headerlink" href="#Fetch-the-structures’-IFPs-(if-available)" title="Permalink to this heading">¶</a></h4>
<p>We fetch the IFPs for the set of structures. Not all structures will have an IFP because not all structures have a co-crystallized ligand.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ifps_df</span> <span class="o">=</span> <span class="n">klifs_session</span><span class="o">.</span><span class="n">interactions</span><span class="o">.</span><span class="n">by_structure_klifs_id</span><span class="p">(</span><span class="n">structure_klifs_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of structures with IFPs: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ifps_df</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">ifps_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of structures with IFPs: 1466
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>structure.klifs_id</th>
<th>interaction.fingerprint</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>775</td>
<td>0000000000000010000000000000000000000000000000...</td>
</tr>
<tr>
<th>1</th>
<td>777</td>
<td>0000000000000010000001000000000000000000000000...</td>
</tr>
<tr>
<th>2</th>
<td>778</td>
<td>0000000000000010000000000000000000000000000000...</td>
</tr>
<tr>
<th>3</th>
<td>779</td>
<td>0000000000000010000001000000000000000000000000...</td>
</tr>
<tr>
<th>4</th>
<td>782</td>
<td>0000000000000010000001000000000000000000000000...</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="Merge-structural-and-IFP-data">
<h4 id="Merge-structural-and-IFP-data">Merge structural and IFP data<a class="headerlink" href="#Merge-structural-and-IFP-data" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">structures_with_ifps_df</span> <span class="o">=</span> <span class="n">ifps_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">structures_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">"structure.klifs_id"</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"inner"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of structures with IFPs: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">structures_with_ifps_df</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">structures_with_ifps_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of structures with IFPs: 1466
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>structure.klifs_id</th>
<th>interaction.fingerprint</th>
<th>kinase.klifs_name</th>
<th>species.klifs</th>
<th>structure.dfg</th>
<th>structure.resolution</th>
<th>structure.qualityscore</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>775</td>
<td>0000000000000010000000000000000000000000000000...</td>
<td>EGFR</td>
<td>Human</td>
<td>in</td>
<td>3.00</td>
<td>8.0</td>
</tr>
<tr>
<th>1</th>
<td>777</td>
<td>0000000000000010000001000000000000000000000000...</td>
<td>EGFR</td>
<td>Human</td>
<td>in</td>
<td>2.64</td>
<td>6.8</td>
</tr>
<tr>
<th>2</th>
<td>778</td>
<td>0000000000000010000000000000000000000000000000...</td>
<td>EGFR</td>
<td>Human</td>
<td>in</td>
<td>1.90</td>
<td>8.0</td>
</tr>
<tr>
<th>3</th>
<td>779</td>
<td>0000000000000010000001000000000000000000000000...</td>
<td>EGFR</td>
<td>Human</td>
<td>in</td>
<td>2.80</td>
<td>8.0</td>
</tr>
<tr>
<th>4</th>
<td>782</td>
<td>0000000000000010000001000000000000000000000000...</td>
<td>EGFR</td>
<td>Human</td>
<td>in</td>
<td>1.70</td>
<td>8.0</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="Show-kinase-coverage">
<h3 id="Show-kinase-coverage">Show kinase coverage<a class="headerlink" href="#Show-kinase-coverage" title="Permalink to this heading">¶</a></h3>
<p>Let’s get the number of structures that describe our kinases (kinase coverage).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use pandas' groupby method to count the number of structures (rows) per kinase</span>
<span class="n">n_structures_per_kinase</span> <span class="o">=</span> <span class="n">structures_with_ifps_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"kinase.klifs_name"</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="n">n_structures_per_kinase</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kinase.klifs_name
ErbB2      4
KDR        6
LCK       30
p110a     45
BRAF      57
MET       95
p38a     127
EGFR     339
CDK2     763
dtype: int64
</pre></div></div>
</div>
<p>Let’s plot the results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">n_structures_per_kinase</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">"barh"</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Number of structures"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Kinase name"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_structures_per_kinase</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">va</span><span class="o">=</span><span class="s2">"center"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T026_kinase_similarity_ifp_41_0.png" src="../_images/talktorials_T026_kinase_similarity_ifp_41_0.png"/>
</div>
</div>
<p>We see that our dataset is highly imbalanced. While some kinases are structurally resolved very often, other kinases are not. We will have to keep this in mind when interpreting our results later.</p>
</section>
<section id="Compare-structures">
<h3 id="Compare-structures">Compare structures<a class="headerlink" href="#Compare-structures" title="Permalink to this heading">¶</a></h3>
<p>We will make a pairwise comparison of the structures’ IFP using the Tanimoto/Jaccard distance as implemented in <code class="docutils literal notranslate"><span class="pre">sklearn.metrics.pairwise_distances</span></code>, which uses under the hood the method <code class="docutils literal notranslate"><span class="pre">scipy.spatial.distance</span></code>.</p>
<section id="Prepare-IFPs-as-numpy-array">
<h4 id="Prepare-IFPs-as-numpy-array">Prepare IFPs as <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array<a class="headerlink" href="#Prepare-IFPs-as-numpy-array" title="Permalink to this heading">¶</a></h4>
<p>KLIFS deposits the IFP as a string of 0’s and 1’s. We have to convert the IFPs to an array of boolean vectors (required by <code class="docutils literal notranslate"><span class="pre">scipy.spatial.distance</span></code> to be able to use the Jaccard distance). Each row in this array refers to one IFP, each columns to one of the IFP’s features.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is the KLIFS format of the IFP (structure KLIFS ID and kinase name set as index)</span>
<span class="n">ifp_series</span> <span class="o">=</span> <span class="n">structures_with_ifps_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">"structure.klifs_id"</span><span class="p">,</span> <span class="s2">"kinase.klifs_name"</span><span class="p">])[</span>
    <span class="s2">"interaction.fingerprint"</span>
<span class="p">]</span>
<span class="n">ifp_series</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
structure.klifs_id  kinase.klifs_name
775                 EGFR                 0000000000000010000000000000000000000000000000...
777                 EGFR                 0000000000000010000001000000000000000000000000...
778                 EGFR                 0000000000000010000000000000000000000000000000...
779                 EGFR                 0000000000000010000001000000000000000000000000...
782                 EGFR                 0000000000000010000001000000000000000000000000...
Name: interaction.fingerprint, dtype: string
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cast "0" and "1" to boolean False and True</span>
<span class="n">ifp_series</span> <span class="o">=</span> <span class="n">ifp_series</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="s2">"1"</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
<span class="n">ifp_series</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
structure.klifs_id  kinase.klifs_name
775                 EGFR                 [False, False, False, False, False, False, Fal...
777                 EGFR                 [False, False, False, False, False, False, Fal...
778                 EGFR                 [False, False, False, False, False, False, Fal...
779                 EGFR                 [False, False, False, False, False, False, Fal...
782                 EGFR                 [False, False, False, False, False, False, Fal...
Name: interaction.fingerprint, dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to numpy array</span>
<span class="n">ifps_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ifp_series</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
<span class="n">ifps_array</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       ...,
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])
</pre></div></div>
</div>
</section>
<section id="Calculate-pairwise-Jaccard-distances">
<h4 id="Calculate-pairwise-Jaccard-distances">Calculate pairwise Jaccard distances<a class="headerlink" href="#Calculate-pairwise-Jaccard-distances" title="Permalink to this heading">¶</a></h4>
<p>The Jaccard distance, defined below, is often used in case of binary fingerprints:</p>
<div class="math notranslate nohighlight">
\[d_J(A,B) = 1 - J(A,B) = \frac{\mid A \cup B \mid - \mid A \cap B \mid}{\mid A \cup B \mid}.\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">structure_distance_matrix_array</span> <span class="o">=</span> <span class="n">pairwise_distances</span><span class="p">(</span><span class="n">ifps_array</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">"jaccard"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create DataFrame with structure KLIFS IDs as index/columns</span>
<span class="n">structure_klifs_ids</span> <span class="o">=</span> <span class="n">ifp_series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">structure_distance_matrix_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">structure_distance_matrix_array</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">structure_klifs_ids</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">structure_klifs_ids</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Structure distance matrix size: </span><span class="si">{</span><span class="n">structure_distance_matrix_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Show matrix subset:"</span><span class="p">)</span>
<span class="n">structure_distance_matrix_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Structure distance matrix size: (1466, 1466)
Show matrix subset:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>structure.klifs_id</th>
<th>775</th>
<th>777</th>
<th>778</th>
<th>779</th>
<th>782</th>
</tr>
<tr>
<th>structure.klifs_id</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>775</th>
<td>0.000000</td>
<td>0.720000</td>
<td>0.542857</td>
<td>0.500000</td>
<td>0.483871</td>
</tr>
<tr>
<th>777</th>
<td>0.720000</td>
<td>0.000000</td>
<td>0.741935</td>
<td>0.500000</td>
<td>0.703704</td>
</tr>
<tr>
<th>778</th>
<td>0.542857</td>
<td>0.741935</td>
<td>0.000000</td>
<td>0.696970</td>
<td>0.411765</td>
</tr>
<tr>
<th>779</th>
<td>0.500000</td>
<td>0.500000</td>
<td>0.696970</td>
<td>0.000000</td>
<td>0.655172</td>
</tr>
<tr>
<th>782</th>
<td>0.483871</td>
<td>0.703704</td>
<td>0.411765</td>
<td>0.655172</td>
<td>0.000000</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="Map-structure-to-kinase-distance-matrix">
<h3 id="Map-structure-to-kinase-distance-matrix">Map structure to kinase distance matrix<a class="headerlink" href="#Map-structure-to-kinase-distance-matrix" title="Permalink to this heading">¶</a></h3>
<p>Note: So far we compared individual structures, but we want to compare kinases (which can be represented by several structures, as plotted above).</p>
<p>First, as an intermediate step, we will create a structure distance matrix but — instead of labeling the data with structure KLIFS IDs — we use the corresponding kinase name.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copy distance matrix to kinase matrix</span>
<span class="n">kinase_distance_matrix_df</span> <span class="o">=</span> <span class="n">structure_distance_matrix_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># Replace structure KLIFS IDs with the structures' kinase names</span>
<span class="n">kinase_names</span> <span class="o">=</span> <span class="n">ifp_series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">kinase_distance_matrix_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">kinase_names</span>
<span class="n">kinase_distance_matrix_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">kinase_names</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Show matrix subset:"</span><span class="p">)</span>
<span class="n">kinase_distance_matrix_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Show matrix subset:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>kinase.klifs_name</th>
<th>EGFR</th>
<th>EGFR</th>
<th>EGFR</th>
<th>EGFR</th>
<th>EGFR</th>
</tr>
<tr>
<th>kinase.klifs_name</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>EGFR</th>
<td>0.000000</td>
<td>0.720000</td>
<td>0.542857</td>
<td>0.500000</td>
<td>0.483871</td>
</tr>
<tr>
<th>EGFR</th>
<td>0.720000</td>
<td>0.000000</td>
<td>0.741935</td>
<td>0.500000</td>
<td>0.703704</td>
</tr>
<tr>
<th>EGFR</th>
<td>0.542857</td>
<td>0.741935</td>
<td>0.000000</td>
<td>0.696970</td>
<td>0.411765</td>
</tr>
<tr>
<th>EGFR</th>
<td>0.500000</td>
<td>0.500000</td>
<td>0.696970</td>
<td>0.000000</td>
<td>0.655172</td>
</tr>
<tr>
<th>EGFR</th>
<td>0.483871</td>
<td>0.703704</td>
<td>0.411765</td>
<td>0.655172</td>
<td>0.000000</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p>A kinase pair can be represented by many different structure pairs which are associated with different distance values.</p>
<p>For example (in the demo mode), if we compare all EGFR structure to each other, the range of distance values is already quite high because we can observe different binding modes of the co-crystallized ligands.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">DEMO</span><span class="p">:</span>
    <span class="n">example</span> <span class="o">=</span> <span class="s2">"EGFR"</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">example</span> <span class="o">=</span> <span class="n">kinase_selection_df</span><span class="p">[</span><span class="s2">"kinase_klifs"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Select EGFR-EGFR structure pairs only</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">kinase_distance_matrix_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">example</span><span class="p">,</span> <span class="n">example</span><span class="p">]</span>
<span class="c1"># Extract all pairwise distances without identical structure pairs</span>
<span class="c1"># = lower triangular matrix without the diagonal</span>
<span class="n">D_condensed</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">squareform</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="c1"># Plot pairwise distances</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">D_condensed</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">example</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Distance between structures"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T026_kinase_similarity_ifp_54_0.png" src="../_images/talktorials_T026_kinase_similarity_ifp_54_0.png"/>
</div>
</div>
<p>In this talktorial, we will consider per kinase pair the two structures that show the most similar binding mode for their co-crystallized ligands. Hence, we select the structure pair with the minimum IFP distance as representative for a kinase pair.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We unstack the matrix (each pairwise comparison in a single row)</span>
<span class="c1"># We group by kinase names (level=[0, 1] ensures that the order of the kinases is ignored</span>
<span class="c1"># We take the minimum value in each kinase pair group</span>
<span class="c1"># We unstack the remaining data points</span>
<span class="n">kinase_distance_matrix_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">kinase_distance_matrix_df</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">kinase_distance_matrix_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">kinase_distance_matrix_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">"Structure matrix of shape </span><span class="si">{</span><span class="n">structure_distance_matrix_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> "</span>
    <span class="sa">f</span><span class="s2">"reduced to kinase matrix of shape </span><span class="si">{</span><span class="n">kinase_distance_matrix_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">."</span>
<span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Structure matrix of shape (1466, 1466) reduced to kinase matrix of shape (9, 9).
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show matrix with background gradient</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">light_palette</span><span class="p">(</span><span class="s2">"green"</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">kinase_distance_matrix_df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
#T_dd0ab_row0_col0, #T_dd0ab_row1_col1, #T_dd0ab_row2_col2, #T_dd0ab_row3_col3, #T_dd0ab_row4_col4, #T_dd0ab_row5_col5, #T_dd0ab_row6_col6, #T_dd0ab_row7_col7, #T_dd0ab_row8_col8 {
  background-color: #ebf3eb;
  color: #000000;
}
#T_dd0ab_row0_col1, #T_dd0ab_row2_col7, #T_dd0ab_row8_col0 {
  background-color: #4ea64e;
  color: #f1f1f1;
}
#T_dd0ab_row0_col2, #T_dd0ab_row4_col0, #T_dd0ab_row5_col3 {
  background-color: #3f9f3f;
  color: #f1f1f1;
}
#T_dd0ab_row0_col3 {
  background-color: #49a449;
  color: #f1f1f1;
}
#T_dd0ab_row0_col4 {
  background-color: #4ba54a;
  color: #f1f1f1;
}
#T_dd0ab_row0_col5, #T_dd0ab_row3_col4 {
  background-color: #379b37;
  color: #f1f1f1;
}
#T_dd0ab_row0_col6 {
  background-color: #209020;
  color: #f1f1f1;
}
#T_dd0ab_row0_col7 {
  background-color: #1d8e1d;
  color: #f1f1f1;
}
#T_dd0ab_row0_col8 {
  background-color: #45a245;
  color: #f1f1f1;
}
#T_dd0ab_row1_col0 {
  background-color: #5eae5e;
  color: #f1f1f1;
}
#T_dd0ab_row1_col2 {
  background-color: #a6d2a6;
  color: #000000;
}
#T_dd0ab_row1_col3 {
  background-color: #319831;
  color: #f1f1f1;
}
#T_dd0ab_row1_col4, #T_dd0ab_row2_col4 {
  background-color: #82c082;
  color: #000000;
}
#T_dd0ab_row1_col5, #T_dd0ab_row8_col2, #T_dd0ab_row8_col5 {
  background-color: #80bf80;
  color: #000000;
}
#T_dd0ab_row1_col6 {
  background-color: #a2cfa2;
  color: #000000;
}
#T_dd0ab_row1_col7 {
  background-color: #5cad5c;
  color: #f1f1f1;
}
#T_dd0ab_row1_col8 {
  background-color: #61af61;
  color: #f1f1f1;
}
#T_dd0ab_row2_col0 {
  background-color: #68b368;
  color: #f1f1f1;
}
#T_dd0ab_row2_col1 {
  background-color: #b2d7b1;
  color: #000000;
}
#T_dd0ab_row2_col3, #T_dd0ab_row8_col3 {
  background-color: #81bf81;
  color: #000000;
}
#T_dd0ab_row2_col5 {
  background-color: #8ec58e;
  color: #000000;
}
#T_dd0ab_row2_col6 {
  background-color: #6eb66e;
  color: #f1f1f1;
}
#T_dd0ab_row2_col8 {
  background-color: #95c995;
  color: #000000;
}
#T_dd0ab_row3_col0 {
  background-color: #329832;
  color: #f1f1f1;
}
#T_dd0ab_row3_col1, #T_dd0ab_row3_col5, #T_dd0ab_row3_col7, #T_dd0ab_row7_col0, #T_dd0ab_row7_col2, #T_dd0ab_row7_col3, #T_dd0ab_row7_col4, #T_dd0ab_row7_col6, #T_dd0ab_row7_col8 {
  background-color: #008000;
  color: #f1f1f1;
}
#T_dd0ab_row3_col2 {
  background-color: #4ba54b;
  color: #f1f1f1;
}
#T_dd0ab_row3_col6, #T_dd0ab_row7_col5 {
  background-color: #198c19;
  color: #f1f1f1;
}
#T_dd0ab_row3_col8 {
  background-color: #6bb46b;
  color: #f1f1f1;
}
#T_dd0ab_row4_col1 {
  background-color: #6fb76f;
  color: #f1f1f1;
}
#T_dd0ab_row4_col2, #T_dd0ab_row6_col4 {
  background-color: #57ab57;
  color: #f1f1f1;
}
#T_dd0ab_row4_col3 {
  background-color: #43a143;
  color: #f1f1f1;
}
#T_dd0ab_row4_col5 {
  background-color: #cae3ca;
  color: #000000;
}
#T_dd0ab_row4_col6 {
  background-color: #349934;
  color: #f1f1f1;
}
#T_dd0ab_row4_col7 {
  background-color: #108810;
  color: #f1f1f1;
}
#T_dd0ab_row4_col8 {
  background-color: #d5e9d5;
  color: #000000;
}
#T_dd0ab_row5_col0 {
  background-color: #55a955;
  color: #f1f1f1;
}
#T_dd0ab_row5_col1 {
  background-color: #88c388;
  color: #000000;
}
#T_dd0ab_row5_col2 {
  background-color: #84c084;
  color: #000000;
}
#T_dd0ab_row5_col4 {
  background-color: #d1e6d1;
  color: #000000;
}
#T_dd0ab_row5_col6 {
  background-color: #61b061;
  color: #f1f1f1;
}
#T_dd0ab_row5_col7 {
  background-color: #50a750;
  color: #f1f1f1;
}
#T_dd0ab_row5_col8 {
  background-color: #8dc58d;
  color: #000000;
}
#T_dd0ab_row6_col0 {
  background-color: #3e9e3e;
  color: #f1f1f1;
}
#T_dd0ab_row6_col1 {
  background-color: #a6d1a6;
  color: #000000;
}
#T_dd0ab_row6_col2, #T_dd0ab_row6_col5 {
  background-color: #5fae5f;
  color: #f1f1f1;
}
#T_dd0ab_row6_col3 {
  background-color: #4da64d;
  color: #f1f1f1;
}
#T_dd0ab_row6_col7 {
  background-color: #3a9c3a;
  color: #f1f1f1;
}
#T_dd0ab_row6_col8 {
  background-color: #3c9d3c;
  color: #f1f1f1;
}
#T_dd0ab_row7_col1 {
  background-color: #359a35;
  color: #f1f1f1;
}
#T_dd0ab_row8_col1 {
  background-color: #5aac5a;
  color: #f1f1f1;
}
#T_dd0ab_row8_col4 {
  background-color: #d8ead8;
  color: #000000;
}
#T_dd0ab_row8_col6 {
  background-color: #299429;
  color: #f1f1f1;
}
#T_dd0ab_row8_col7 {
  background-color: #289328;
  color: #f1f1f1;
}
</style>
<table id="T_dd0ab">
<thead>
<tr>
<th class="blank level0"> </th>
<th class="col_heading level0 col0" id="T_dd0ab_level0_col0">BRAF</th>
<th class="col_heading level0 col1" id="T_dd0ab_level0_col1">CDK2</th>
<th class="col_heading level0 col2" id="T_dd0ab_level0_col2">EGFR</th>
<th class="col_heading level0 col3" id="T_dd0ab_level0_col3">ErbB2</th>
<th class="col_heading level0 col4" id="T_dd0ab_level0_col4">KDR</th>
<th class="col_heading level0 col5" id="T_dd0ab_level0_col5">LCK</th>
<th class="col_heading level0 col6" id="T_dd0ab_level0_col6">MET</th>
<th class="col_heading level0 col7" id="T_dd0ab_level0_col7">p110a</th>
<th class="col_heading level0 col8" id="T_dd0ab_level0_col8">p38a</th>
</tr>
</thead>
<tbody>
<tr>
<th class="row_heading level0 row0" id="T_dd0ab_level0_row0">BRAF</th>
<td class="data row0 col0" id="T_dd0ab_row0_col0">0.000</td>
<td class="data row0 col1" id="T_dd0ab_row0_col1">0.300</td>
<td class="data row0 col2" id="T_dd0ab_row0_col2">0.278</td>
<td class="data row0 col3" id="T_dd0ab_row0_col3">0.394</td>
<td class="data row0 col4" id="T_dd0ab_row0_col4">0.364</td>
<td class="data row0 col5" id="T_dd0ab_row0_col5">0.320</td>
<td class="data row0 col6" id="T_dd0ab_row0_col6">0.368</td>
<td class="data row0 col7" id="T_dd0ab_row0_col7">0.500</td>
<td class="data row0 col8" id="T_dd0ab_row0_col8">0.333</td>
</tr>
<tr>
<th class="row_heading level0 row1" id="T_dd0ab_level0_row1">CDK2</th>
<td class="data row1 col0" id="T_dd0ab_row1_col0">0.300</td>
<td class="data row1 col1" id="T_dd0ab_row1_col1">0.000</td>
<td class="data row1 col2" id="T_dd0ab_row1_col2">0.111</td>
<td class="data row1 col3" id="T_dd0ab_row1_col3">0.452</td>
<td class="data row1 col4" id="T_dd0ab_row1_col4">0.238</td>
<td class="data row1 col5" id="T_dd0ab_row1_col5">0.190</td>
<td class="data row1 col6" id="T_dd0ab_row1_col6">0.133</td>
<td class="data row1 col7" id="T_dd0ab_row1_col7">0.348</td>
<td class="data row1 col8" id="T_dd0ab_row1_col8">0.278</td>
</tr>
<tr>
<th class="row_heading level0 row2" id="T_dd0ab_level0_row2">EGFR</th>
<td class="data row2 col0" id="T_dd0ab_row2_col0">0.278</td>
<td class="data row2 col1" id="T_dd0ab_row2_col1">0.111</td>
<td class="data row2 col2" id="T_dd0ab_row2_col2">0.000</td>
<td class="data row2 col3" id="T_dd0ab_row2_col3">0.258</td>
<td class="data row2 col4" id="T_dd0ab_row2_col4">0.238</td>
<td class="data row2 col5" id="T_dd0ab_row2_col5">0.167</td>
<td class="data row2 col6" id="T_dd0ab_row2_col6">0.227</td>
<td class="data row2 col7" id="T_dd0ab_row2_col7">0.381</td>
<td class="data row2 col8" id="T_dd0ab_row2_col8">0.174</td>
</tr>
<tr>
<th class="row_heading level0 row3" id="T_dd0ab_level0_row3">ErbB2</th>
<td class="data row3 col0" id="T_dd0ab_row3_col0">0.394</td>
<td class="data row3 col1" id="T_dd0ab_row3_col1">0.452</td>
<td class="data row3 col2" id="T_dd0ab_row3_col2">0.258</td>
<td class="data row3 col3" id="T_dd0ab_row3_col3">0.000</td>
<td class="data row3 col4" id="T_dd0ab_row3_col4">0.406</td>
<td class="data row3 col5" id="T_dd0ab_row3_col5">0.419</td>
<td class="data row3 col6" id="T_dd0ab_row3_col6">0.382</td>
<td class="data row3 col7" id="T_dd0ab_row3_col7">0.571</td>
<td class="data row3 col8" id="T_dd0ab_row3_col8">0.258</td>
</tr>
<tr>
<th class="row_heading level0 row4" id="T_dd0ab_level0_row4">KDR</th>
<td class="data row4 col0" id="T_dd0ab_row4_col0">0.364</td>
<td class="data row4 col1" id="T_dd0ab_row4_col1">0.238</td>
<td class="data row4 col2" id="T_dd0ab_row4_col2">0.238</td>
<td class="data row4 col3" id="T_dd0ab_row4_col3">0.406</td>
<td class="data row4 col4" id="T_dd0ab_row4_col4">0.000</td>
<td class="data row4 col5" id="T_dd0ab_row4_col5">0.059</td>
<td class="data row4 col6" id="T_dd0ab_row4_col6">0.333</td>
<td class="data row4 col7" id="T_dd0ab_row4_col7">0.533</td>
<td class="data row4 col8" id="T_dd0ab_row4_col8">0.043</td>
</tr>
<tr>
<th class="row_heading level0 row5" id="T_dd0ab_level0_row5">LCK</th>
<td class="data row5 col0" id="T_dd0ab_row5_col0">0.320</td>
<td class="data row5 col1" id="T_dd0ab_row5_col1">0.190</td>
<td class="data row5 col2" id="T_dd0ab_row5_col2">0.167</td>
<td class="data row5 col3" id="T_dd0ab_row5_col3">0.419</td>
<td class="data row5 col4" id="T_dd0ab_row5_col4">0.059</td>
<td class="data row5 col5" id="T_dd0ab_row5_col5">0.000</td>
<td class="data row5 col6" id="T_dd0ab_row5_col6">0.250</td>
<td class="data row5 col7" id="T_dd0ab_row5_col7">0.375</td>
<td class="data row5 col8" id="T_dd0ab_row5_col8">0.190</td>
</tr>
<tr>
<th class="row_heading level0 row6" id="T_dd0ab_level0_row6">MET</th>
<td class="data row6 col0" id="T_dd0ab_row6_col0">0.368</td>
<td class="data row6 col1" id="T_dd0ab_row6_col1">0.133</td>
<td class="data row6 col2" id="T_dd0ab_row6_col2">0.227</td>
<td class="data row6 col3" id="T_dd0ab_row6_col3">0.382</td>
<td class="data row6 col4" id="T_dd0ab_row6_col4">0.333</td>
<td class="data row6 col5" id="T_dd0ab_row6_col5">0.250</td>
<td class="data row6 col6" id="T_dd0ab_row6_col6">0.000</td>
<td class="data row6 col7" id="T_dd0ab_row6_col7">0.429</td>
<td class="data row6 col8" id="T_dd0ab_row6_col8">0.353</td>
</tr>
<tr>
<th class="row_heading level0 row7" id="T_dd0ab_level0_row7">p110a</th>
<td class="data row7 col0" id="T_dd0ab_row7_col0">0.500</td>
<td class="data row7 col1" id="T_dd0ab_row7_col1">0.348</td>
<td class="data row7 col2" id="T_dd0ab_row7_col2">0.381</td>
<td class="data row7 col3" id="T_dd0ab_row7_col3">0.571</td>
<td class="data row7 col4" id="T_dd0ab_row7_col4">0.533</td>
<td class="data row7 col5" id="T_dd0ab_row7_col5">0.375</td>
<td class="data row7 col6" id="T_dd0ab_row7_col6">0.429</td>
<td class="data row7 col7" id="T_dd0ab_row7_col7">0.000</td>
<td class="data row7 col8" id="T_dd0ab_row7_col8">0.474</td>
</tr>
<tr>
<th class="row_heading level0 row8" id="T_dd0ab_level0_row8">p38a</th>
<td class="data row8 col0" id="T_dd0ab_row8_col0">0.333</td>
<td class="data row8 col1" id="T_dd0ab_row8_col1">0.278</td>
<td class="data row8 col2" id="T_dd0ab_row8_col2">0.174</td>
<td class="data row8 col3" id="T_dd0ab_row8_col3">0.258</td>
<td class="data row8 col4" id="T_dd0ab_row8_col4">0.043</td>
<td class="data row8 col5" id="T_dd0ab_row8_col5">0.190</td>
<td class="data row8 col6" id="T_dd0ab_row8_col6">0.353</td>
<td class="data row8 col7" id="T_dd0ab_row8_col7">0.474</td>
<td class="data row8 col8" id="T_dd0ab_row8_col8">0.000</td>
</tr>
</tbody>
</table></div>
</div>
<p>Note: Since this is a distance matrix, lighter colors indicate similarity, darker colors dissimilarity.</p>
</section>
<section id="Save-kinase-distance-matrix">
<h3 id="Save-kinase-distance-matrix">Save kinase distance matrix<a class="headerlink" href="#Save-kinase-distance-matrix" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kinase_distance_matrix_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">DATA</span> <span class="o">/</span> <span class="s2">"kinase_distance_matrix.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Discussion">
<h2 id="Discussion">Discussion<a class="headerlink" href="#Discussion" title="Permalink to this heading">¶</a></h2>
<p>In this talktorial, we have used the KLIFS interaction fingerprints, which describe binding modes of co-crystallized ligands in kinase structures, to assess kinase similarity.</p>
<p>We have to keep two elements in mind:</p>
<ul class="simple">
<li><p>Interaction fingerprints may miss important key interactions if the co-crystallized ligand(s) simply do not form the interaction but other ligands might.</p></li>
<li><p>We only compare here the two closest binding modes per kinase pair, although we have — for kinases such as EGFR and CDK2 — much more data available on binding modes. As an alternative, one could instead aggregate the information from multiple binding modes per kinase in a fingerprint that reports all interactions seen in any structure. However, this approach has its own drawbacks: Some kinases have much higher coverage than others, leading to an imbalance in information content.</p></li>
</ul>
<p>The kinase distance matrix above will be reloaded in <strong>Talktorial T028</strong>, where we compare kinase similarities from different perspectives, including the interaction perspective we have talked about in this talktorial.</p>
</section>
<section id="Quiz">
<h2 id="Quiz">Quiz<a class="headerlink" href="#Quiz" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>What are the advantages and disadvantages of describing kinase similarity with interaction fingerprints?</p></li>
<li><p>Why is the structural coverage between kinases so different?</p></li>
<li><p>At one point, we are mapping structure pairs to kinase pairs. We use here the minimum structure distance. What other mapping strategies can you think of? What advantages and disadvantages could they have?</p></li>
</ol>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script></section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="T025_kinase_similarity_kissim.html" title="T025 · Kinase similarity: Kinase pocket (KiSSim fingerprint)"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> T025 · Kinase similarity: Kinase pocket (KiSSim fingerprint) </span>
              </div>
            </a>
          
          
            <a href="T027_kinase_similarity_ligand_profile.html" title="T027 · Kinase similarity: Ligand profile"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> T027 · Kinase similarity: Ligand profile </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2018-2022, Volkamer Lab. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.1.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>